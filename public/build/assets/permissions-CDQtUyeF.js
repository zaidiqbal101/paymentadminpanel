import{r as n,j as e,x as h,y as _,z as D,A as C}from"./app-0-mZ052T.js";import{M as j}from"./map-pin-DNGSb2gH.js";function A(){const[y,m]=n.useState([]),[N,b]=n.useState(!1),[l,d]=n.useState(null),[v,w]=n.useState(null),[x,g]=n.useState({fields:[{key:"name",value:"",type:"text",placeholder:"Enter Name"},{key:"display_name",value:"",type:"text",placeholder:"Enter Display Name"},{key:"type",value:"",type:"text",placeholder:"Enter Type"}]}),[c,i]=n.useState(!1),[u,o]=n.useState(null);n.useEffect(()=>{async function s(){i(!0);try{const t=await h();m(t)}catch(t){console.error("Error fetching permissions:",t),o("Failed to load permissions")}finally{i(!1)}}s()},[]);const k=(s,t)=>{const{value:r}=t.target,a=[...x.fields];a[s].value=r,g(p=>({...p,fields:a}))},E=s=>{d({...s}),w({...s})},P=s=>{const{name:t,value:r}=s.target;d(a=>({...a,[t]:r}))},S=async s=>{if(confirm(`Are you sure you want to delete permission "${s.display_name}"?`))try{i(!0),await _(s.id),alert("Permission deleted successfully");const t=await h();m(t)}catch(t){console.error("Error deleting permission:",t),alert("Failed to delete permission")}finally{i(!1)}},f=async s=>{s.preventDefault(),i(!0),o(null);try{if(l!=null&&l.id){const t={};if(Object.keys(l).forEach(a=>{l[a]!==v[a]&&(t[a]=l[a])}),console.log("Updated Fields for Edit:",t),Object.keys(t).length===0){alert("No changes made."),d(null);return}const r=await D(l.id,t);if(r.message==="Permission updated successfully"){alert("Permission updated successfully");const a=await h();m(a),d(null)}else o(r.message||"Update failed")}else{const t=x.fields.reduce((a,p)=>(a[p.key]=p.value,a),{});console.log("Form Values for Add:",t);const r=await C(t);if(r.message==="Permission added successfully"){alert("New permission added successfully");const a=await h();m(a),g({fields:[{key:"name",value:"",type:"text",placeholder:"Enter Name"},{key:"display_name",value:"",type:"text",placeholder:"Enter Display Name"},{key:"type",value:"",type:"text",placeholder:"Enter Type"}]}),b(!1)}else o(r.message||"Failed to add permission")}}catch(t){if(console.error("Error submitting permission:",t),t.response&&t.response.status===422){const r=t.response.data.errors||{},a=Object.values(r).flat().join(", ")||"Validation errors";o(a)}else o("Failed to submit permission")}finally{i(!1)}};return e.jsxs("div",{className:"max-w-full bg-gray-100 mt-2 w-full",children:[e.jsxs("div",{className:"bg-gray-700 flex justify-between p-2 rounded-lg shadow-lg",children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"Permissions"}),e.jsx("button",{className:"px-2 py-1 bg-primary_color text-white font-semibold rounded hover:bg-secondary_color hover:scale-105 transition duration-300",onClick:()=>b(!0),children:"Add New+"})]}),e.jsx("div",{className:"p-4",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-400 shadow-md rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-gradient-to-r from-green-900 via-green-500 to-pink-300 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2",children:"ID"}),e.jsx("th",{className:"border p-2",children:"Name"}),e.jsx("th",{className:"border p-2",children:"Display Name"}),e.jsx("th",{className:"border p-2",children:"Type"}),e.jsx("th",{className:"border p-2",children:"Last Updated Date"}),e.jsx("th",{className:"border p-2",children:"Action"})]})}),e.jsx("tbody",{children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center p-4",children:"Loading..."})}):y.length>0?y.map(s=>e.jsxs("tr",{className:"border text-center",children:[e.jsx("td",{className:"p-2 border",children:s.id}),e.jsx("td",{className:"p-2 border",children:s.name}),e.jsx("td",{className:"p-2 border",children:s.display_name}),e.jsx("td",{className:"p-2 border",children:s.type}),e.jsx("td",{className:"p-2 border",children:s.updated_at?new Date(s.updated_at).toLocaleString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,year:"numeric",month:"2-digit",day:"2-digit"}):"Not updated yet"}),e.jsxs("td",{className:"p-2 border",children:[e.jsx("button",{className:"bg-red-800 text-white px-1 py-1 rounded mr-2 hover:bg-red-900 transition duration-300",onClick:()=>S(s),children:"Delete"}),e.jsx("button",{className:"bg-yellow-500 text-white px-1 py-1 rounded hover:bg-yellow-600 transition duration-300",onClick:()=>E(s),children:"Edit"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center p-4",children:u||"No data available"})})})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center transition-all ease-in-out duration-300",children:e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-lg w-11/12 md:w-2/3 lg:w-1/2 transform scale-100 hover:scale-105 transition-all ease-in-out duration-300",children:e.jsxs("form",{onSubmit:f,children:[x.fields.map((s,t)=>e.jsxs("div",{className:"mb-2 relative group",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s.placeholder}),e.jsx("span",{className:"absolute left-2 transition-transform duration-300 ease-in-out group-hover:scale-125",children:e.jsx(j,{size:20,className:"text-blue-500 animate-bounce"})}),e.jsx("input",{type:s.type,name:s.key,placeholder:s.placeholder,value:s.value,onChange:r=>k(t,r),className:"w-full border p-2 pl-8 rounded focus:ring-2 focus:ring-blue-400 focus:border-blue-600",required:!0})]},s.key)),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{type:"submit",className:"bg-primary_color text-black p-1 rounded font-bold hover:bg-secondary_color hover:scale-105 transition duration-300",disabled:c,children:c?"Submitting...":"Submit"}),e.jsx("button",{type:"button",className:"bg-gray-300 text-gray-700 p-1 rounded hover:bg-gray-400 transition duration-300",onClick:()=>b(!1),children:"Close"})]}),u&&e.jsx("p",{className:"text-red-600 text-center mt-2",children:u})]})})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center transition-all ease-in-out duration-300",children:e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-lg w-11/12 md:w-2/3 lg:w-1/2 transform scale-100 hover:scale-105 transition-all ease-in-out duration-300",children:e.jsxs("form",{onSubmit:f,children:[[{key:"name",label:"Name",value:l.name||""},{key:"display_name",label:"Display Name",value:l.display_name||""},{key:"type",label:"Type",value:l.type||""}].map(s=>e.jsxs("div",{className:"mb-2 relative group",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:s.label}),e.jsx("span",{className:"absolute left-2 transition-transform duration-300 ease-in-out group-hover:scale-125",children:e.jsx(j,{size:20,className:"text-blue-500 animate-bounce"})}),e.jsx("input",{type:"text",name:s.key,value:s.value,onChange:P,className:"w-full border p-2 pl-8 rounded focus:ring-2 focus:ring-blue-400 focus:border-blue-600",required:!0})]},s.key)),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{type:"submit",className:"bg-primary_color text-black p-1 rounded font-bold hover:bg-secondary_color hover:scale-105 transition duration-300",disabled:c,children:c?"Submitting...":"Submit"}),e.jsx("button",{type:"button",className:"bg-gray-300 text-gray-700 p-1 rounded hover:bg-gray-400 transition duration-300",onClick:()=>d(null),children:"Close"})]}),u&&e.jsx("p",{className:"text-red-600 text-center mt-2",children:u})]})})})]})}export{A as default};
