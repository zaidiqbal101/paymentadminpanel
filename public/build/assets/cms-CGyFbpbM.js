import{r as d,j as e,C as h,U as g}from"./app-0-mZ052T.js";function y(){const[c,n]=d.useState([]),[r,o]=d.useState(null),[a,l]=d.useState(null),[x,m]=d.useState(null);d.useEffect(()=>{async function s(){try{const t=await h();n(t.data.data||[])}catch(t){console.error("Error fetching CMS data:",t),n([])}}s()},[]);const b=s=>{o(s)},p=s=>{l({...s}),m({...s})},u=s=>{const t=s.target.value.replace("%","");l({...a,Commission:t})},j=async()=>{var s;try{const t={};if(a.Commission!==x.Commission&&(t.Commission=a.Commission),Object.keys(t).length===0){alert("No changes detected!");return}await g(a.Agent_ID,t),alert("Commission updated successfully!");const i=await h();(s=i==null?void 0:i.data)!=null&&s.data&&n(i.data.data),l(null),m(null)}catch(t){alert("Failed to update commission."),console.error("Error updating commission:",t)}};return e.jsxs("div",{className:"max-w-full bg-gray-100 mt-6",children:[e.jsx("div",{className:"bg-gray-700 flex justify-between p-4",children:e.jsx("h3",{className:"text-white font-bold",children:"Utility Commission"})}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 mt-4",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.no"}),e.jsx("th",{className:"border p-2",children:"Agent ID"}),e.jsx("th",{className:"border p-2",children:"Agent Name"}),e.jsx("th",{className:"border p-2",children:"Commission"}),e.jsx("th",{className:"border p-2",children:"Last Updated"}),e.jsx("th",{className:"border p-2",children:"Actions"})]})}),e.jsx("tbody",{children:c.length>0?c.map((s,t)=>e.jsxs("tr",{className:"border",children:[e.jsx("td",{className:"p-2 border text-center",children:t+1}),e.jsx("td",{className:"p-2 border text-center",children:s.Agent_ID}),e.jsx("td",{className:"p-2 border text-center",children:s.Agent_Name}),e.jsxs("td",{className:"p-2 border text-center",children:[s.Commission,"%"]}),e.jsx("td",{className:"border p-2",children:s.updated_at?new Date(s.updated_at).toLocaleString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,year:"numeric",month:"2-digit",day:"2-digit"}):"Not updated yet"}),e.jsx("td",{className:"p-2 border text-center",children:e.jsx("button",{className:"bg-blue-500 text-white px-2 py-1 rounded mr-2",onClick:()=>b(s),children:"View Details"})})]},t)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center p-4",children:"No data available"})})})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-2xl w-11/12 md:w-2/3 lg:w-2/3 max-h-[80vh] overflow-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold",children:["Details for ",r.Agent_Name]}),e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-red-600",onClick:()=>o(null),children:"Close"})]}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 mt-4",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2",children:"Agent ID"}),e.jsx("th",{className:"border p-2",children:"Agent Name"}),e.jsx("th",{className:"border p-2",children:"Category"}),e.jsx("th",{className:"border p-2",children:"Commission"}),e.jsx("th",{className:"border p-2",children:"Last Updated"}),e.jsx("th",{className:"border p-2",children:"Edit"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"border",children:[e.jsx("td",{className:"p-2 border",children:r.Agent_ID}),e.jsx("td",{className:"p-2 border",children:r.Agent_Name}),e.jsx("td",{className:"p-2 border",children:r.category||"N/A"}),e.jsxs("td",{className:"p-2 border",children:[r.Commission,"%"]}),e.jsx("td",{className:"p-2 border",children:r.updated_at?new Date(r.updated_at).toLocaleString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,year:"numeric",month:"2-digit",day:"2-digit"}):"Not updated yet"}),e.jsx("td",{className:"p-2 border",children:e.jsx("button",{className:"bg-yellow-500 text-white px-2 py-1 rounded",onClick:()=>p(r),children:"Edit"})})]})})]})]})}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-11/12 md:w-2/3 lg:w-2/3",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 text-center mb-4",children:"Edit Commission"}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2",children:"Agent ID"}),e.jsx("th",{className:"border p-2",children:"Agent Name"}),e.jsx("th",{className:"border p-2",children:"Commission"}),e.jsx("th",{className:"border p-2",children:"Last Updated"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"border p-2",children:a.Agent_ID}),e.jsx("td",{className:"border p-2",children:a.Agent_Name}),e.jsx("td",{className:"border p-2",children:e.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:`${a.Commission}%`,onChange:u})}),e.jsx("td",{className:"border p-2",children:a.updated_at?new Date(a.updated_at).toLocaleString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,year:"numeric",month:"2-digit",day:"2-digit"}):"Not updated yet"})]})})]}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",onClick:j,children:"Save"}),e.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>l(null),children:"Cancel"})]})]})})]})}export{y as default};
