import{r as o,j as e}from"./app-CVSLwbXb.js";import{O as _,f as u,d as v}from"./apis-BrEZBuSk.js";function S(){const[n,i]=o.useState([]),[c,l]=o.useState([]),[m,j]=o.useState({}),[h,x]=o.useState(null),[t,d]=o.useState(null),[p,b]=o.useState(null);o.useEffect(()=>{async function s(){try{const r=await _();if(!r||!r.data||!r.data.data){console.error("Invalid response format:",r),i([]);return}i(r.data.data)}catch(r){console.error("Error fetching operators:",r),i([])}}async function a(){try{const r=await u();if(!r||!r.data||!r.data.data){console.error("Invalid response format:",r.data),l([]);return}l(r.data.data)}catch(r){console.error("Error fetching commission:",r),l([])}}s(),a()},[]);const N=s=>{j(a=>({...a,[s]:!a[s]}))},g=async s=>{x(s)},f=async s=>{const a=c.find(r=>r.operator_id===s.operator_id);d(a),b(a)},y=async()=>{var s;try{const a={};if(t.server_1_commission!==p.server_1_commission&&(a.server_1_commission=t.server_1_commission),t.server_2_commission!==p.server_2_commission&&(a.server_2_commission=t.server_2_commission),Object.keys(a).length===0){alert("No changes detected!");return}await v(t.operator_id,a),alert("Commission updated successfully!"),d(null),b(null);const r=await u();(s=r==null?void 0:r.data)!=null&&s.data&&l(r.data.data)}catch(a){alert("Failed to update commission."),console.error(a)}};return e.jsxs("div",{className:"max-w-full bg-gray-100 mt-6",children:[e.jsx("div",{className:"bg-gray-700 flex justify-between p-4",children:e.jsx("h3",{className:"text-white font-bold",children:"Operator List"})}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 mt-4",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2",children:"ID"}),e.jsx("th",{className:"border p-2",children:"Operator Name"}),e.jsx("th",{className:"border p-2",children:"Status"}),e.jsx("th",{className:"border p-2",children:"Actions"})]})}),e.jsx("tbody",{children:n.length>0?n.map(s=>e.jsxs("tr",{className:"border",children:[e.jsx("td",{className:"p-2 border",children:s.operator_id}),e.jsx("td",{className:"p-2 border",children:s.operator_name}),e.jsx("td",{className:"p-2 border",children:e.jsx("button",{className:`px-4 py-1 rounded-full ${m[s.operator_id]?"bg-green-500 text-white":"bg-red-500 text-white"}`,onClick:()=>N(s.operator_id),children:m[s.operator_id]?"Active":"Inactive"})}),e.jsxs("td",{className:"p-2 border",children:[e.jsx("button",{className:"bg-blue-500 text-white px-2 py-1 rounded mr-2",onClick:()=>g(s),children:"View Details"}),e.jsx("button",{className:"bg-yellow-500 text-white px-2 py-1 rounded",onClick:()=>f(s),children:"Edit Details"})]})]},s.operator_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center p-4",children:"No data available"})})})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center transition-all ease-in-out duration-300",children:e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-2xl w-11/12 md:w-2/3 lg:w-1/2 transform scale-100 hover:scale-105 transition-all ease-in-out duration-300",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:"Commission Details"}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 shadow-md rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-300 to-gray-200 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-3",children:"ID"}),e.jsx("th",{className:"border p-3",children:"Operator Name"}),e.jsx("th",{className:"border p-3",children:"Category"}),e.jsx("th",{className:"border p-3",children:"Server 1 Commission"}),e.jsx("th",{className:"border p-3",children:"Server 2 Commission"}),e.jsx("th",{className:"border p-3",children:"Last Updated date"})]})}),e.jsx("tbody",{className:"bg-gray-50",children:(()=>{const s=c.find(a=>a.operator_id===h.operator_id);return s?e.jsxs("tr",{className:"hover:bg-gray-100 transition-all ease-in-out duration-200",children:[e.jsx("td",{className:"border p-3 text-center",children:s.id}),e.jsx("td",{className:"border p-3 text-center",children:s.operator_name}),e.jsx("td",{className:"border p-3 text-center",children:s.category||"N/A"}),e.jsx("td",{className:"border p-3 text-center",children:s.server_1_commission||"N/A"}),e.jsx("td",{className:"border p-3 text-center",children:s.server_2_commission||"N/A"}),e.jsx("td",{className:"border p-3 text-center",children:s.updated_at?new Date(s.updated_at).toISOString().split("T")[0]:"N/A"})]}):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"border p-3 text-center text-red-500 font-semibold",children:"No Data Found"})})})()})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsx("button",{className:"bg-red-500 text-white px-5 py-2 rounded-lg shadow-md hover:bg-red-600 transition-all duration-200",onClick:()=>x(null),children:"Close"})})]})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-3/4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 text-center mb-4",children:"Edit Commission Details"}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2",children:"ID"}),e.jsx("th",{className:"border p-2",children:"Operator Name"}),e.jsx("th",{className:"border p-2",children:"Category"}),e.jsx("th",{className:"border p-2",children:"Server 1 Commission"}),e.jsx("th",{className:"border p-2",children:"Server 2 Commission"}),e.jsx("th",{className:"border p-2",children:"Last Updated"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"border p-2",children:t.operator_id}),e.jsx("td",{className:"border p-2",children:t.operator_name}),e.jsx("td",{className:"border p-2",children:t.category}),e.jsx("td",{className:"border p-2",children:e.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:(t==null?void 0:t.server_1_commission)??"",onChange:s=>d({...t,server_1_commission:s.target.value})})}),e.jsx("td",{className:"border p-2",children:e.jsx("input",{type:"text",className:"w-full border p-2 rounded",value:t.server_2_commission??"",onChange:s=>d({...t,server_2_commission:s.target.value})})}),e.jsx("td",{className:"border p-2",children:t.updated_at||"Not updated yet"})]})})]}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:y,children:"Save"}),e.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded ml-2",onClick:()=>d(null),children:"Cancel"})]})]})})]})}export{S as default};
